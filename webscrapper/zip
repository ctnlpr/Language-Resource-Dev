{"files":[{"id":"bad85b78-197f-46ca-864a-aa980bde542b","name":"Code","type":"server_js","source":"function myFunction() {\n  var folders \u003d DriveApp.getFolderById(\u00270ByLGhvnaCIQsdzJpQk13Z1BUelE\u0027).getFolders();\n  var folder;\n  while(folders.hasNext()){\n    folder \u003d folders.next()\n    var zipped \u003d Utilities.zip(getBlobs(folder, \u0027\u0027), folder.getName()+\u0027.zip\u0027);\n    folder.getParents().next().createFile(zipped);\n  }\n}\nfunction getBlobs(rootFolder, path) {\n  var blobs \u003d [];\n  var names \u003d {};\n  var files \u003d rootFolder.getFiles();\n  while (files.hasNext()) {\n    var file \u003d files.next().getBlob();\n    var n \u003d file.getName();\n    while(names[n]) { n \u003d \u0027_\u0027 + n }\n    names[n] \u003d true;\n    blobs.push(file.setName(path+n));\n  }\n  names \u003d {};\n  var folders \u003d rootFolder.getFolders();\n  while (folders.hasNext()) {\n    var folder \u003d folders.next();\n    var n \u003d folder.getName();\n    while(names[n]) { n \u003d \u0027_\u0027 + n }\n    names[n] \u003d true;\n    var fPath \u003d path+n+\u0027/\u0027;\n    blobs.push(Utilities.newBlob([]).setName(fPath)); //comment/uncomment this line to skip/include empty folders\n    blobs \u003d blobs.concat(getBlobs(folder, fPath));\n  }\n  return blobs;\n}"}]}